
[tox]
envlist = check, py39, py310, pypy39

; Base tests
[testenv]
passenv = *
deps = pipenv
commands =
    pipenv install --dev
    pipenv run pytest -s

; Linting and import tests with flake, black and isort
[testenv:check]
passenv = *
basepython = python3.9
deps = 
    pipenv
    isort
    black
    flake8
    mypy
commands =
    pipenv install --dev
    pipenv run isort --filter-files .
    pipenv run black --preview .
    pipenv run flake8 --ignore=E203,W503
    pipenv run mypy gigue

# The Flake8 rules ignored are justified by black:
# https://black.readthedocs.io/en/stable/faq.html#why-are-flake8-s-e203-and-w503-violated

# pipenv run isort --verbose --check-only --diff --filter-files .
# ; Run code coverage and report with codecov/coverage
# [testenv:cover]
# basepython = python3.8
# deps = 
#     codecov
#     coverage
# skip_install = true
# commands =
#     codecov []
#     coverage report
#     coverage html
